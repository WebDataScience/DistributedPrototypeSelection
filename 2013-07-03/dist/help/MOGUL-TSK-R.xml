<method>

    <name>Local Evolutionary Learning of TSK fuzzy rule-based system (LEL-TSK)</name>

    <reference>

		<ref>R. Alcal&#xE1;, J. Alcal&#xE1;-Fdez, J. Casillas, O. Cord&#xF3;n, F. Herrera, Local identification of prototypes for genetic learning of accurate TSK fuzzy rule-based systems, International Journal of Intelligent Systems (2007), in press</ref>        
        
    </reference>

    <generalDescription>

        <type>Regression model by generation of fuzzy rule-based systems</type>

        <objective>To obtain a TSK (Takagi-Sugeno-Kang) fuzzy rule-based system</objective>

        <howWork>This algorithm performs a local identification of prototypes to induce competition among rules by only considering the quality of the approximation performed by each rule. The method consists of three stages: generation of initial TSK rules, simplification and tuning.

        1. Local Process for Identifying Prototypes. This method induces competition among rules, considering the completeness and consistency. The completeness is verified demanding that each example is covered to a degree "epsilon". On the other hand, to verify the consistency, the positive and negative example concepts are considered. Thereby, the accuracy of a simple fuzzy rule (with global or local nature), Rh, on the set of examples, E, is measured by using a multicriteria fitness function designed to take into account three different criteria: high frequency value, high average covering degree over positive examples and small negative example set.

           This method may be briefly summarized in the following steps:

              - Define a strong fuzzy partition for each variable (triangular-shaped membership functions uniformly distributed).

              - Generate for each example the global fuzzy rule best covering it. Then, evaluate all the global fuzzy rules and select the most promising rule.

              - This rule is locally tuned to identify the local fuzzy prototype best grouping the data located in the corresponding subspace. This process is performed by means of a (1+1)-Evolution Strategy ((1+1)-ES) considering a fitness function with a penalty function to avoid excessive proximity among prototypes.

              - Finally, the obtained prototype is added to the final set of fuzzy prototypes. The data covered by this set to a certain degree are removed and not considered for future iterations. The iterative process ends up when no more uncovered training data remains.

           To obtain the TSK consequents, once the set of local fuzzy prototypes is obtained and considering the same antecedents, the existing partial linear input-output relation is computed using the data located in each input subspace by means of a (mu,lambda)-ES.

         2. Genetic simplification process: The simplification process is based on a binary-coded GA with fixed-length chromosomes. Considering the rules contained in the rule set derived from the previous step counted from 1 to m, an m-bit string C = (c1, ..., cm) represents a subset of candidate rules to form the fuzzy rule base finally obtained as this stage output such that if ci = 1 then Ri is included in the selected rule set.

         The selection of the individuals is developed using the Baker's stochastic universal sampling procedure together with an elitist selection scheme, and the recombination is put into effect using the classical binary multipoint crossover (performed at two points) and uniform mutation operators. The fitness function is composed of the mean square error over the training data set (to reward the similarity between the model and the data set) and a covering measure (to penalize the lack of the completeness property obtained in the previous stage).         The initial population is generated by introducing a chromosome representing the complete previously obtained rule set, i.e, all genes set to 1. The remaining chromosomes are selected at random.

         3. Genetic tuning process: It is based on a hybrid GA-ES algorithm in which each individual represents a complete knowledge base. An (1+1)-ES is considered as a genetic operator to locally tune a percentage of the best individuals in each generation. In this method, the variation interval is independently estimated for each fuzzy set.
		 
		 Since the following values usually report significantly better results than  those recommended in the paper for the following three parameters: 
		    Size of the Standar Deviation String MOGUL = 6
			Recombination Operator for the Solution String MOGUL = 3 
			Recombination Operator for the Deviation String MOGUL = 2 
		
		 We have used them as default (recommended) algorithm parameters instead of the original ones initially recommended in the paper (respectively 2, 2, 0). 

        </howWork>

        <parameterSpec>
             <param>Evolutionary strategy iterations</param>
             <param>Number of parents for the evolutionary strategy</param>
             <param>Number of offspring for the evolutionary strategy</param>
             <param>Size of the standar deviation string</param>
             <param>Size of the angle string</param>
             <param>Recombination operator for the solution string</param>
             <param>Recombination operator for the deviation string</param>
             <param>Recombination operator for the angle string</param>
             <param>Number of parents to recombine the solution string</param>
             <param>Number of parents to recombine the deviation string</param>
             <param>Number of parents to recombine the angle string</param>
             <param>Application of the evolution strategy (1+1)</param>
             <param>Evolution strategy iterations (1+1)</param>
             <param>Type of niches</param>
             <param>Omega parameter for the matching degree of the positive instances</param>
             <param>K parameter for the percentage of allowed negative instances</param>
             <param>Epsilon parameter for the minimun matching degree required to the KB</param>
             <param>Type of fitness function</param>
             <param>Number of labels of each variable</param>
             <param>Evolutionary strategy iterations MOGUL</param>
             <param>Number of parents for the evolutionary strategy (the number of parents for the evolutionary strategy must be lesser than the number of offspring) MOGUL</param>
             <param>Number of offspring for the evolutionary strategy MOGUL</param>
             <param>Size of the standar deviation string MOGUL</param>
             <param>Size of the angle string MOGUL</param>
             <param>Recombination operator for the solution string MOGUL</param>
             <param>Recombination operator for the deviation string MOGUL</param>
             <param>Recombination operator for the angle string MOGUL</param>
             <param>Number of parents to recombine the solution string MOGUL</param>
             <param>Number of parents to recombine the deviation string MOGUL</param>
             <param>Number of parents to recombine the angle string MOGUL</param>             
             <param>Number of Iterations SELECT</param>
             <param>Population Size SELECT</param>
             <param>Tau parameter for the minimun maching degree required to the KB SELECT</param>
             <param>Rate of Rules that don't are eliminated SELECT</param>
             <param>Rate of rules to estimate the niche radio SELECT</param>
             <param>Beta parameter for the Power Law SELECT</param>
             <param>Type of Fitness Function SELECT</param>
             <param>Cross Probability SELECT</param>
             <param>Mutation Probability SELECT</param>             
           <param>Number of iterations TUNING</param>
           <param>Population size TUNING</param>
           <param>Parameter a (max-min-arithmetical crossover) TUNING</param>
           <param>Parameter b (non-uniform mutation of Michalewicz) TUNING</param>
           <param>Cross probability TUNING</param>
           <param>Mutation probability TUNING</param>
           <param>Rate of the Population to which the ES is applied TUNING</param>
           <param>Evolutionary Strategy Iterations TUNING</param>             
        </parameterSpec>

        <properties>
            <continuous>Yes</continuous>
            <discretized>Yes (only with numerical)</discretized>
            <integer>Yes</integer>
            <nominal>No</nominal>
            <valueLess>Yes</valueLess>
            <impreciseValue>No</impreciseValue>
        </properties>

    </generalDescription>

    <example>Problem type: Regression
        Method: Regr-Fuzzy-LEL_TSK
        Dataset: ele1
        Parameters: default values

        After the execution of RunKeel.jar we can see into the experiment\results\Regr-Fuzzy-LEL_TSK the results. 
        The file 'result0s0e0.txt' contains the TSK fuzzy rule set and the approximation errors on training and test datasets
        for the first step of the execution (TSK (Takagi-Sugeno-Kang) fuzzy rule-based system):

Numero de reglas: 25

2.1970724516896873 3.001448361534017 125.16091215041412
-134.6437632560145 407.7457297201884 1065.6855288610047
-959.375 1082.80489638464 4728.621646626033

3.0530816859436136 3.0530816859436136 125.04166146158279
-141.6662445 744.3480658757538 744.4336364393838
-959.375 1684.4454557600504 4786.381881838495

10.539282502916622 10.539282502916622 124.0202811325343
-36.328035695106266 235.90848728818878 1059.9730091870554
-947.8332134844788 733.0952813225341 4737.030022461214

-45.58034361979958 -34.637676784500805 75.49057011862217
-91.48722530880622 -51.72231544270741 1067.187586905783
-958.2084223052623 407.20117941054497 4796.875

25.875 82.42284634651709 149.00833722507366
-535.4278025735733 582.9638465254068 664.9987335000001
-681.3649785932419 2187.326923961134 4796.875

159.9654774898758 193.96032393753265 272.1238728279577
-128.9146530699679 613.7374447433689 671.3891876641447
1079.775176252561 3044.6164876579555 5800.563158884406

-73.58178583322814 19.393959785091702 24.566634555010513
22.094559659898362 22.309370979751105 290.86129383652946
-2625.5257077354186 318.1558758021395 2878.125

-39.45955870115495 25.06413117700317 39.07517080145349
1112.281189373591 1266.8094853614275 2175.2070587269413
1802.6650568009038 1804.7735560985232 6675.16964903836

-43.740350075727015 12.545827373121714 48.36957481804925
1262.960321941792 1663.4119978902243 2078.4207242322414
1356.311218142253 4016.034629448164 5944.288311228358

196.12455456371774 196.12455456371774 274.625
-141.6662445 678.5140347645024 678.5140347645024
2649.0841298827636 2649.0841298827636 6715.625

-23.875 105.03986370261192 105.03986370261192
664.9987335 682.5152834336066 1874.9962005
959.375 4174.912036379615 6715.625

25.32130782176615 25.32130782176615 125.375
664.9987335 809.4522803656619 1874.9962005
959.375 2561.8885047975878 6714.838380506137

34.68803814546748 123.97440550006014 175.11365502093963
-535.4536719676976 562.0955942330708 566.2623963820845
-767.8966736035272 938.6795771033709 4739.7853101795945

-23.69131667711186 93.18089047833229 125.3576727378738
943.8146102169529 943.8146102169529 1874.9962005
1395.1678276006392 1395.1678276006392 6715.625

125.23953438256503 145.54394874930145 224.875
707.0008162345754 1235.3973135731685 1871.7210083917162
2022.4682811574264 3414.0852914266934 6549.626471613279

-29.19882393591081 2.8705732862176276 2.8705828708511207
-544.9987335000001 186.28584041090116 186.28584041090116
-2878.125 551.145620984217 551.145620984217

-71.04283918513218 25.140966049309878 25.140966049309878
746.8294268282068 746.8294268282068 1269.1129905933187
172.63374109628052 2340.6850995432683 4796.139264666075

108.53355466188295 150.58613532136044 224.875
700.9173220360949 1011.0083800486074 1015.0853509325901
2878.125 7171.282571477875 7171.282571477875

102.51448053315116 110.04675858350255 222.3872739846638
-133.45845197191062 902.5803148841691 902.5803148841691
-931.863939543504 4545.791994406598 4777.361805722233

102.24047237115867 102.7928491653935 223.5701554342749
-124.70964389265633 864.8254964221568 936.9940887968547
669.6127301987303 2249.3337248035054 4796.875

177.1931148794593 184.9817014239528 274.625
440.2760036604127 976.6865885083525 1236.8592736518433
2903.6462639583087 6636.465899137328 8479.568997412449

130.4766375879454 130.4766375879454 194.21079013115167
-77.7038117081598 753.5377741443615 797.3024670283344
1748.75154705311 2452.265476498664 5770.058805027701

113.63467418650056 113.63467418650056 221.18283977333166
692.400904935801 692.4487452116796 1469.4927267305527
3055.0456815870525 4225.458278385296 8628.323937120098

127.95156367069748 128.11553354980637 217.59249605004777
665.4364834836673 665.4364834836673 1469.509671652267
2902.155050682334 5452.240939339148 8588.636823205868

-23.875 58.43277080285412 123.50668065974115
665.107764966038 735.8533549845108 1874.9962005
959.375 6099.352956707364 6135.642333212309


MSEtra: 311158.9677448015 MSEtst: 292197.1951852757
Minimun C_R: 0.28639590236915735 MSE CV_R: 0.5078250116629519

While the file 'result0s0e1.txt' contains the considered initial fuzzy semantics:

Initial Data Base: 

  Variable 1:
    Label 1: (-48.75,1.0,50.75)
    Label 2: (1.0,50.75,100.5)
    Label 3: (50.75,100.5,150.25)
    Label 4: (100.5,150.25,200.0)
    Label 5: (150.25,200.0,249.75)

  Variable 2:
    Label 1: (-343.332489,60.0,463.332489)
    Label 2: (60.0,463.332489,866.664978)
    Label 3: (463.332489,866.664978,1269.9974670000001)
    Label 4: (866.664978,1269.9974670000001,1673.329956)
    Label 5: (1269.9974670000001,1673.329956,2076.662445)

  Variable 3:
    Label 1: (-1918.75,0.0,1918.75)
    Label 2: (0.0,1918.75,3837.5)
    Label 3: (1918.75,3837.5,5756.25)
    Label 4: (3837.5,5756.25,7675.0)
    Label 5: (5756.25,7675.0,9593.75)

In the file 'result0s0e2.txt' we may find the TSK rules learned tsk-fuzzy models based on MOGUL:

Numero de reglas: 25

2.1970724516896873 3.001448361534017 125.16091215041412
-134.6437632560145 407.7457297201884 1065.6855288610047
21.26131955389131 0.4021349037070069 700.2204757729894 

3.0530816859436136 3.0530816859436136 125.04166146158279
-141.6662445 744.3480658757538 744.4336364393838
15.987636090943036 1.4998570331429224 377.09924630523665 

10.539282502916622 10.539282502916622 124.0202811325343
-36.328035695106266 235.90848728818878 1059.9730091870554
19.988465229354578 0.11279868281314383 799.9852482081881 

-45.58034361979958 -34.637676784500805 75.49057011862217
-91.48722530880622 -51.72231544270741 1067.187586905783
12.190613326168531 2.6291445571575496 3.5284516877427983 

25.875 82.42284634651709 149.00833722507366
-535.4278025735733 582.9638465254068 664.9987335000001
4.118478170329559 3.6162655862079487 10.589057145267242 

159.9654774898758 193.96032393753265 272.1238728279577
-128.9146530699679 613.7374447433689 671.3891876641447
0.20283920410179948 -0.0047839047905175 3267.928916131258 

-73.58178583322814 19.393959785091702 24.566634555010513
22.094559659898362 22.309370979751105 290.86129383652946
18.645724091585635 0.4721751904084073 87.72308165442747 

-39.45955870115495 25.06413117700317 39.07517080145349
1112.281189373591 1266.8094853614275 2175.2070587269413
68.10275456205518 0.00810348814497502 1626.682705234219 

-43.740350075727015 12.545827373121714 48.36957481804925
1262.960321941792 1663.4119978902243 2078.4207242322414
-42.927429954565206 0.016167299319421822 4374.049975183408 

196.12455456371774 196.12455456371774 274.625
-141.6662445 678.5140347645024 678.5140347645024
-0.0026889166093743665 0.3540903285429915 3109.9029774466094 

-23.875 105.03986370261192 105.03986370261192
664.9987335 682.5152834336066 1874.9962005
27.493586339571984 0.650006351638163 1364.50619214399 

25.32130782176615 25.32130782176615 125.375
664.9987335 809.4522803656619 1874.9962005
21.28285188965432 0.5040593202631121 1978.8997787735536 

34.68803814546748 123.97440550006014 175.11365502093963
-535.4536719676976 562.0955942330708 566.2623963820845
3.905564962983805 0.2829947920716437 1278.432574492619 

-23.69131667711186 93.18089047833229 125.3576727378738
943.8146102169529 943.8146102169529 1874.9962005
20.23038806345619 -0.02343759061898158 2623.790390345256 

125.23953438256503 145.54394874930145 224.875
707.0008162345754 1235.3973135731685 1871.7210083917162
8.826821315788717 0.06725535576104101 4302.481654304314 

-29.19882393591081 2.8705732862176276 2.8705828708511207
-544.9987335000001 186.28584041090116 186.28584041090116
-69.91462842853767 0.44440917763107207 173.21135622403352 

-71.04283918513218 25.140966049309878 25.140966049309878
746.8294268282068 746.8294268282068 1269.1129905933187
8.463967972438173 0.09417603396966559 2197.5341548453885 

108.53355466188295 150.58613532136044 224.875
700.9173220360949 1011.0083800486074 1015.0853509325901
2.566778716059658 0.22301768572732183 5842.810987068292 

102.51448053315116 110.04675858350255 222.3872739846638
-133.45845197191062 902.5803148841691 902.5803148841691
7.684125508576208 1.4226079356530685 1285.360881473085 

102.24047237115867 102.7928491653935 223.5701554342749
-124.70964389265633 864.8254964221568 936.9940887968547
9.79225667810336 2.0130008456570736 582.0901936891436 

177.1931148794593 184.9817014239528 274.625
440.2760036604127 976.6865885083525 1236.8592736518433
-14.108166248467954 0.2666252838124903 8011.441925006716 

130.4766375879454 130.4766375879454 194.21079013115167
-77.7038117081598 753.5377741443615 797.3024670283344
2.969669947755876 0.6684181643021678 1850.7501406763997 

113.63467418650056 113.63467418650056 221.18283977333166
692.400904935801 692.4487452116796 1469.4927267305527
31.537035291272943 0.005711932320563524 1180.486484079313 

127.95156367069748 128.11553354980637 217.59249605004777
665.4364834836673 665.4364834836673 1469.509671652267
12.918329283307028 -0.07249992036801371 4286.382882994656 

-23.875 58.43277080285412 123.50668065974115
665.107764966038 735.8533549845108 1874.9962005
30.070094480581922 0.5252963879282527 1422.8092866889008 


ECMtra: 202114.0382110317  ELMtra: 480.0862732441531
ECMtst: 265924.43938445643  ELMtst: 533.7549690624443

The file 'result0s0e3.txt' contains a selection of the best cooperative rules:

Numero de reglas: 14

2.1970724516896873 3.001448361534017 125.16091215041412
-134.6437632560145 407.7457297201884 1065.6855288610047
21.26131955389131 0.4021349037070069 700.2204757729894 

25.875 82.42284634651709 149.00833722507366
-535.4278025735733 582.9638465254068 664.9987335000001
4.118478170329559 3.6162655862079487 10.589057145267242 

-39.45955870115495 25.06413117700317 39.07517080145349
1112.281189373591 1266.8094853614275 2175.2070587269413
68.10275456205518 0.00810348814497502 1626.682705234219 

196.12455456371774 196.12455456371774 274.625
-141.6662445 678.5140347645024 678.5140347645024
-0.0026889166093743665 0.3540903285429915 3109.9029774466094 

-23.875 105.03986370261192 105.03986370261192
664.9987335 682.5152834336066 1874.9962005
27.493586339571984 0.650006351638163 1364.50619214399 

34.68803814546748 123.97440550006014 175.11365502093963
-535.4536719676976 562.0955942330708 566.2623963820845
3.905564962983805 0.2829947920716437 1278.432574492619 

-23.69131667711186 93.18089047833229 125.3576727378738
943.8146102169529 943.8146102169529 1874.9962005
20.23038806345619 -0.02343759061898158 2623.790390345256 

125.23953438256503 145.54394874930145 224.875
707.0008162345754 1235.3973135731685 1871.7210083917162
8.826821315788717 0.06725535576104101 4302.481654304314 

-71.04283918513218 25.140966049309878 25.140966049309878
746.8294268282068 746.8294268282068 1269.1129905933187
8.463967972438173 0.09417603396966559 2197.5341548453885 

108.53355466188295 150.58613532136044 224.875
700.9173220360949 1011.0083800486074 1015.0853509325901
2.566778716059658 0.22301768572732183 5842.810987068292 

102.51448053315116 110.04675858350255 222.3872739846638
-133.45845197191062 902.5803148841691 902.5803148841691
7.684125508576208 1.4226079356530685 1285.360881473085 

113.63467418650056 113.63467418650056 221.18283977333166
692.400904935801 692.4487452116796 1469.4927267305527
31.537035291272943 0.005711932320563524 1180.486484079313 

127.95156367069748 128.11553354980637 217.59249605004777
665.4364834836673 665.4364834836673 1469.509671652267
12.918329283307028 -0.07249992036801371 4286.382882994656 

-23.875 58.43277080285412 123.50668065974115
665.107764966038 735.8533549845108 1874.9962005
30.070094480581922 0.5252963879282527 1422.8092866889008 



Minimum of C_R: 0.0 Minimum covering degree: 0.0
Average covering degree: 1.0887137673916794 MLE: 541.307958959308
MSEtra: 272096.98390302324 , MSEtst: 441215.9297686711


Finally in file 'result0s0e4.txt' the tuned fuzzy rule base is stored, together with the approximation errors on training and test datasets:

Numero de reglas: 14

1.7948844967675226 2.373451892583413 126.01837887351111
344.9450208763878 346.4738571653669 856.5662577649566
25.21500260293154 0.40230222973220015 685.8588103212068 

-1.6958890217174507 29.008052258134924 177.0765207311666
-1094.6236271230632 684.5287557003195 706.0161769872967
0.018631854882926235 3.4009729055612485 2.062087193693185 

-71.721403640234 25.707029075598452 25.802326152437615
1371.6073888797578 1371.6073888797578 2629.4058454096985
145.29581682610137 0.008023694706478708 1759.6994067069015 

196.38188821741429 264.7132180624179 266.20070538145205
-551.7563841322512 678.5140347645024 678.5140347645024
-0.019732904247935747 0.1416189350839745 2775.722202168939 

46.5485493844041 46.5485493844041 77.20851598560196
656.5339572909413 656.5339572909413 2276.1041213632207
27.989646675389583 1.4252517967861462 1327.5854116671715 

85.33132780044424 85.3321363437405 200.63556083865626
-623.621528732152 568.0854381611208 568.0854381611208
1.8813260041971418 0.2788046878318523 1470.5355985162455 

-32.26342644223197 101.03342823232327 109.20925891516117
1226.8862473636277 2173.4158632055332 2340.5869956415236
20.88734453666611 -0.0012584190406883594 2588.9041573739455 

134.28292230663246 134.4256873296201 264.5405256253493
1625.3730228562692 1724.6391700652712 1724.6391700652712
8.82218671517457 0.06722373075017699 6112.903607759974 

-119.1347418023532 25.140966049309878 25.140966049309878
805.9968854777843 1406.707054527854 1406.989696759204
8.46109656071734 0.09425165152623749 1742.4192578112493 

89.00574816791519 89.71455883867257 262.0192480072942
1016.5615301050553 1016.7700620574659 1016.9456333064342
2.7484211446052496 0.22295308550099788 9.60501417469283 

137.46072391717635 143.4638367559741 278.55753168524444
-651.3940600559025 -36.59975411649934 789.5678789696647
7.685478698158963 0.778631440946069 1306.4476730380281 

113.63467418650056 115.37205567907023 121.83755023477401
692.3769972651199 977.9367175186829 1021.9033902863198
32.44730277674252 0.005765200064184292 1224.6196354315134 

127.87116456712383 127.87116456712383 261.3507046175122
665.4364834836673 665.4406534318673 1166.5993293633594
12.49569002547751 -0.22000919673137065 5142.22304924136 

-64.76890102086688 -64.72808511385325 111.10089554902811
678.6826216431176 678.6826216431176 996.0278206851757
29.997716287761325 0.6152903726090804 1451.4234739092678 


MSEtra: 131192.66276952755  MLEtra: 372.31096409243537
MSEtst: 268967.8255615689  MLEtst: 474.87284932634736
   
    </example>

    
    
</method>